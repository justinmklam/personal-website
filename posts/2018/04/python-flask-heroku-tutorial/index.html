<!doctype html><html lang=en><head><title>From Prototype to Cloud: A Python Recipe Converter</title><meta property="og:image" content="http://justinmklam.com/imgs/blog-imgs/python-heroku-tutorial/modularity comparison.png"><meta property="og:type" content="blog"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-85178257-1"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','UA-85178257-1')</script><script>var shiftWindow=function(){scrollBy(0,-70)};window.addEventListener("hashchange",shiftWindow);function load(){window.location.hash&&shiftWindow()}</script><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="A journey from Jupyter to Flask to Heroku, all in one post."><meta name=author content="Justin Lam"><link rel=stylesheet href=/css/bootstrap-modified.min.css><link rel=stylesheet href=/css/jmklam-portfolio.css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Lato:400,400i,700,700i|Roboto+Slab|DM+Sans:500&display=swap"><link rel=stylesheet href=//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/atom-one-light.min.css><script src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/highlight.min.js></script><link rel=stylesheet href=/css/bootstrap-toc.css></head><body onload=load() data-spy=scroll data-target=#toc><!doctype html><html lang=en><nav class="navbar navbar-inverse navbar-fixed-top" role=navigation><div class=container><div class=navbar-header><button id=hamburger-menu type=button class=navbar-toggle data-toggle=collapse data-target=#bs-example-navbar-collapse-1>
<span class=icon-bar></span><span class=icon-bar></span><span class=icon-bar></span></button>
<a class=navbar-brand href=http://justinmklam.com>Justin Lam</a></div><div class="collapse navbar-collapse" id=bs-example-navbar-collapse-1><ul class="nav navbar-nav"><li><a href=/>Blog</a></li><li><a href=/archives/>Archives</a></li><li><a href=/about/>About</a></li><li><a href=/contact/>Contact</a></li></ul></div></div></nav></html><div class=container id=page-container><div class=row><div class=col-sm-2></div><div class=col-sm-8 id=blog><br><h2 data-toc-skip class=blog-title>From Prototype to Cloud: A Python Recipe Converter</h2><p class=datestamp-index><span class="fa fa-calendar-o"></span>&nbsp Posted on April 6, 2018
<em>&nbsp &middot &nbsp&nbsp13 min read
&nbsp &middot &nbsp
    <span class=disqus-comment-count data-disqus-url=http://justinmklam.com/posts/2018/04/python-flask-heroku-tutorial/#disqus_thread># comments</span>
&nbsp &middot &nbsp
    
    <a class=blog-tag href=/tags/programming>#programming&nbsp</a></em></p><a href=/imgs/blog-imgs/python-heroku-tutorial/modularity%20comparison.png><img class="img-responsive img-span-row blog-header-img" src=/imgs/blog-imgs/python-heroku-tutorial/modularity%20comparison.png></a><div class="blog-content page-content"><p>In case the title wasn&rsquo;t clear, this blog post is about developing a web application using the Python programming language using Jupyter Lab, Flask, and the Heroku platform. If you were looking for an article on python recipes, you can start off with this one on making a <a href=https://mobile-cuisine.com/recipes/recipe-poached-burmese-python-curry/>poached Burmese python curry</a>.</p><h1 id=the-backstory>The Backstory</h1><p>The problem with online baking recipes is that the majority of them use volumetric units. As any civilized baker would know, Patricia&rsquo;s 1 cup of flour may very well be different than Patrick&rsquo;s 1 cup of flour. Maybe Patricia sifted her flour. Maybe Patrick&rsquo;s organic flour is a finer texture. Maybe both Pats <strong>should measure by mass instead of volume</strong> to avoid all this confusion in the first place.</p><p>With this in mind, I was tired of constantly typing &ldquo;1 tbsp baking soda in grams&rdquo; and &ldquo;3 1/4 cup flour in grams&rdquo; into Google every time I came across a new recipe. There had to be a better way, and there was. As usual, Python was staring, patiently waiting for me to make eye contact with it.</p><p>My main reqiurement for this application was to be cross-platform. I wanted to be able to carry these conversions out on my laptop, someone else&rsquo;s desktop, or my smartphone. Although <a href=https://reactjs.org/>React</a> is what all the cool kids talk about these days, I also wanted to develop something fast. Since Python is both excellent at string parsing and easy to work with, it seemed like an appropriate choice.</p><p>After a bit of searching, I came across <a href=http://flask.pocoo.org/>Flask</a> and <a href=https://www.heroku.com/python>Heroku</a> which would allow me to use Python for the entire development process, from prototype to deployment. Super cool.</p><h1 id=the-outline>The Outline</h1><p>This blog post will outline the development of a simple string-parsing application that converts common ingredients measured in cups, tablespoons, and teaspoons to grams.</p><ul><li>Prototype the recipe conversions in <a href=https://blog.jupyter.org/jupyterlab-is-ready-for-users-5a6f039b8906>Jupyter Lab&rsquo;s</a> interactive environment</li><li>Migrate script to <a href=https://code.visualstudio.com/>Visual Studio Code</a> to a command line interface</li><li>Integrate the Python script with <a href=http://flask.pocoo.org/>Flask&rsquo;s web framework</a></li><li>Set up and deploy the app through the <a href=https://www.heroku.com/python>Heroku cloud platform</a></li></ul><p><strong>Interested in trying it out?</strong> It&rsquo;s live at <a href=http://recipe-converter-app.herokuapp.com/>recipe-converter-app.herokuapp.com</a>!</p><hr><h1 id=the-development>The Development</h1><h2 id=prototyping-in-jupyter>Prototyping in Jupyter</h2><p>Sure you can do all your development in a text editor and command line. There&rsquo;s nothing wrong with putting print statements everywhere, or even having a Python console open to do scratchpad-type testing. But when a tool as flexible and great as Jupyter is available for everyone to use, why settle for anything else?</p><blockquote><p>The reason for Jupyter’s immense success is it excels in a form of programming called <strong>&ldquo;literate programming&rdquo;</strong>. It emphasizes a prose first approach where exposition with human-friendly text is punctuated with code blocks. It excels at demonstration, research, and teaching objectives - <a href=https://unidata.github.io/online-python-training/introduction.html>Unidata</a></p></blockquote><p>One of its greatest selling points is the option to execute code in chunks and see what the output is at each step. For data science, pairing this with the ability to write markdown above or below the code block makes documentation and explanations a joy to work with.</p><div class="row captioned-img"><a href=/imgs/blog-imgs/python-heroku-tutorial/jupyter%20demo%20gif.gif><img class="img-responsive img-content" src=/imgs/blog-imgs/python-heroku-tutorial/jupyter%20demo%20gif.gif></a><p class=caption>The power of Jupyter's interactive output makes prototyping almost effortless. (Source: <a href=http://n-s-f.github.io/2017/03/25/r-to-python.html>Noam Finkelstein</a>)</p></div><div class="row captioned-img"><a href=/imgs/blog-imgs/python-heroku-tutorial/jupyter%20lab.png><img class="img-responsive img-content" src=/imgs/blog-imgs/python-heroku-tutorial/jupyter%20lab.png></a><p class=caption>Jupyter Lab is the successor to Jupyter (previously iPython) Notebook. The tabbed interface is a godsend. (Source: <a href=https://blog.jupyter.org/jupyterlab-is-ready-for-users-5a6f039b8906>Jupyter</a>)</p></div><h3 id=on-to-the-prototype>On To The Prototype</h3><p>The proposed use case is described below. Nothing complex happening, just a handful of string parsing operations and a conversion table lookup.</p><ol><li>Copy ingredient list to clipboard</li><li>Run script</li><li>Display converted ingredient list</li></ol><p>In the run script method (ie. the meat and potatoes of the app):</p><ol><li>Store clipboard text to list data structure*</li><li>Parse fractions to floats</li><li>Unpack abbreviations (ie. tbsp = tablespoon)</li><li>Find each original ingredient in conversion table and convert to grams (where possible)</li><li>Repeat Step 4 for each provided ingredient</li></ol><p><em>*Turns out it&rsquo;s easy to get clipboard data from a locally running script, but not as straightforward when the script is being hosted on a browser. I guess the user will just have to paste the ingredients into a textbox instead.</em></p><div class="row captioned-img"><a href=/imgs/blog-imgs/python-heroku-tutorial/conversions.PNG><img class="img-responsive img-content" src=/imgs/blog-imgs/python-heroku-tutorial/conversions.PNG></a><p class=caption>Imperial volume to metric mass (gram) conversions in a csv file, ie. the wrong units to the right ones.</p></div><p>Checking out my <a href=https://github.com/justinmklam/recipe-converter/blob/3a4c109a1eb7604cb01cc3f615b37e73e08273ca/.ipynb_checkpoints/Recipe%20Converter-checkpoint.ipynb>first working version</a>, you&rsquo;ll see that it&rsquo;s not the most efficient script. However, when proving out a concept, the priority is to get something working (ie. a minimum viable product) and optimize later. Since uncertainty of this working (or being worth it) is quite high, we don&rsquo;t want to spend too much time making it perfect!</p><div class="row captioned-img"><a href=/imgs/blog-imgs/python-heroku-tutorial/converter%20-%20jupyter%20demo.gif><img class="img-responsive img-content" src=/imgs/blog-imgs/python-heroku-tutorial/converter%20-%20jupyter%20demo.gif></a><p class=caption>Testing out the prototype in Jupyter.</p></div><p>Comparing that with the <a href=https://github.com/justinmklam/recipe-converter/blob/master/Recipe%20Converter%20PoC.ipynb>current version</a>, we can see that the code structure went from messy and repetitive to organized and modular. Cleaning up code is always mildly therapeutic.</p><div class="row captioned-img"><a href=/imgs/blog-imgs/python-heroku-tutorial/modularity%20comparison.png><img class="img-responsive img-content" src=/imgs/blog-imgs/python-heroku-tutorial/modularity%20comparison.png></a><p class=caption>Repetitive version on left, modular version on right.</p></div><p>Now that we&rsquo;ve finished testing the prototype and are happy with how it works, we can move on to the next step in turning it into a browser-based application.</p><h2 id=migrating-to-visual-studio-code>Migrating to Visual Studio Code</h2><p>Fortunately, this is painless! In Jupyter, navigate to <code>File > Export Notebook As... > Executable Script</code>, and that&rsquo;s it. A Python script will download with all the cells in a single executable file.</p><div class="row captioned-img"><a href=/imgs/blog-imgs/python-heroku-tutorial/export%20from%20jupyter.png><img class="img-responsive img-content" src=/imgs/blog-imgs/python-heroku-tutorial/export%20from%20jupyter.png></a><p class=caption>Exporting from Jupyter Lab to the next phase of development: the command line.</p></div><div class="row captioned-img"><a href=/imgs/blog-imgs/python-heroku-tutorial/vs%20code.png><img class="img-responsive img-content" src=/imgs/blog-imgs/python-heroku-tutorial/vs%20code.png></a><p class=caption>A bit of clean up later and the python script is ready to be imported as a module.</p></div><p>Feel free to check out the cleaned up file on <a href=https://github.com/justinmklam/recipe-converter/blob/master/recipeConverter.py>GitHub</a>. That was easy.</p><h2 id=integrating-with-flask>Integrating with Flask</h2><h3 id=like-the-thing-used-in-chemistry>Like the Thing Used in Chemistry?</h3><p>No, this Flask is different! There are many options for web development in Python, with two heavy hitters being Flask and Django. They&rsquo;re both great frameworks, but where Django is the more fully-featured framework, Flask follows the Unix philosophy of &ldquo;do one thing and do it well&rdquo;.</p><blockquote><p>Flask is a lightweight WSGI web application framework. It is designed to make getting started quick and easy, with the ability to scale up to complex applications. It began as a simple wrapper around Werkzeug and Jinja and has become one of the most popular Python web application frameworks.</p></blockquote><blockquote><p>Flask offers suggestions, but doesn&rsquo;t enforce any dependencies or project layout. It is up to the developer to choose the tools and libraries they want to use. There are many extensions provided by the community that make adding new functionality easy. - <a href=https://github.com/pallets/flask>Flask GitHub</a></p></blockquote><p>For myself (and this app), I chose Flask because of its simplicity and upfront/visible functionality. The function routing, template rendering is called explicitly with functions, with little magic happening &ldquo;behind the scenes&rdquo;. As <a href=https://stackoverflow.com/questions/12781655/flask-or-django-for-a-beginner>this answer from StackOverflow</a> puts it, &ldquo;Django can be a little more mysterious for a beginner to figure out how everything fits together&rdquo;.</p><p>Recommended reading:</p><ul><li><a href=http://flask.pocoo.org/docs/0.11/quickstart/>Flask Quickstart</a></li><li><a href=http://flask.pocoo.org/docs/dev/cli/>Running Flask from the Command Line</a></li><li><a href=https://pythonspot.com/flask-web-forms/>Flask Simple Web Form Tutorial</a></li><li><a href=http://flask.pocoo.org/docs/dev/tutorial/#tutorial>Blogging Application Tutorial</a></li></ul><h3 id=running-with-flask>Running With Flask</h3><p>Now the fun really begins. We can start off by firing up a terminal and installing (and updating) the Flask microframework:</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>&gt; pip install -U Flask
</code></pre></div><p>The simplest example of Flask is shown below (taken from <a href=https://en.wikipedia.org/wiki/Flask_(web_framework)#Example>Wikipedia</a>). If you copy it below and execute the script, a blank webpage will render and display &ldquo;Hello World!&rdquo; in your browser.</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#00f>from</span> flask <span style=color:#00f>import</span> Flask
app = Flask(__name__)

@app.route(<span style=color:#a31515>&#34;/&#34;</span>)
<span style=color:#00f>def</span> hello():
    <span style=color:#00f>return</span> <span style=color:#a31515>&#34;Hello World!&#34;</span>

<span style=color:#00f>if</span> __name__ == <span style=color:#a31515>&#34;__main__&#34;</span>:
    app.run()
</code></pre></div><p>The main difference here is the <code>route()</code> decorator. Modern web frameworks use routing techniques to help keep tracak of application URLs. This decorator is used to bind a Python function to a URL. In this case, the URL is <code>/</code>, otherwise known as the index / home / default page. If we were to change it to <code>/hello</code>, then we&rsquo;d have to navigate to <code>localhost:5000/hello</code> to see &ldquo;Hello World!&rdquo;.</p><div class="row captioned-img"><a href=/imgs/blog-imgs/python-heroku-tutorial/hello%20flask.gif><img class="img-responsive img-content" src=/imgs/blog-imgs/python-heroku-tutorial/hello%20flask.gif></a><p class=caption>Saying hello from localhost:5000.</p></div><p>Now moving on to our recipe converter, we need two parts to make this work:</p><ul><li>Flask python script for the backend</li><li>HTML template for the frontend</li></ul><h4 id=apppy-aka-the-back-end>App.py (aka the Back End)</h4><p>Looking at the code below, there isn&rsquo;t much difference from the simple &ldquo;hello world&rdquo; application from above. One key change is the inclusion of <code>methods = ['GET', 'POST']</code> in the <code>route()</code> decorator. From the <a href=http://flask.pocoo.org/docs/0.12/quickstart/>quickstart</a> guide:</p><blockquote><p><strong>GET</strong> - The browser tells the server to just get the information stored on that page and send it.</p></blockquote><blockquote><p><strong>POST</strong> - The browser tells the server that it wants to post some new information to that URL and that the server must ensure the data is stored and only stored once. This is how HTML forms usually transmit data to the server.</p></blockquote><p>Since we are going to have a few buttons on our webpage, we need to include these HTTP methods. With multiple buttons, we can do a simple value check to handle them differently.</p><p>The second key change is returning <code>render_template()</code> in the routed function call. Since we want to be able to format an HTML page, we can use a template (running on <a href=http://jinja.pocoo.org/docs/2.10/>Jinja2</a>) to create one.</p><p>We can also pass variables to the template. In this case, <code>textarea</code> is where the user will enter the ingredient list. When the &lsquo;Convert&rsquo; button is clicked, the text will be parsed by <code>parse_form_text()</code>. To display the parsed/converted recipe, we can use the <code>flash()</code> method, which Flask provides as a feedback mechanism to the users (see <a href=http://flask.pocoo.org/docs/0.12/patterns/flashing/>Message Flashing</a>).</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#00f>from</span> flask <span style=color:#00f>import</span> Flask, request, render_template, flash
<span style=color:#00f>import</span> recipeConverter <span style=color:#00f>as</span> rc

<span style=color:green># Stuff to initialize the Flask app</span>
app = Flask(__name__)
app.config.from_object(__name__)
app.config[<span style=color:#a31515>&#39;SECRET_KEY&#39;</span>] = <span style=color:#a31515>&#39;7d441f27d441f28567d441f2b6176a&#39;</span>   <span style=color:green># this can be anything</span>

<span style=color:green># This decorator tells Flask to use this function as a webpage handler/renderer</span>
@app.route(<span style=color:#a31515>&#39;/&#39;</span>, methods=[<span style=color:#a31515>&#39;GET&#39;</span>, <span style=color:#a31515>&#39;POST&#39;</span>])
<span style=color:#00f>def</span> hello():
    <span style=color:green># Default text to display in the HTML template</span>
    input_text = <span style=color:#a31515>&#34;Hello world!&#34;</span>

    <span style=color:green># Normal page load calls &#39;GET&#39;. &#39;POST&#39; gets called when one of the buttons is pressed</span>
    <span style=color:#00f>if</span> request.method == <span style=color:#a31515>&#39;POST&#39;</span>:
        <span style=color:green># Check which button was pressed</span>
        <span style=color:#00f>if</span> request.form[<span style=color:#a31515>&#39;submit&#39;</span>] == <span style=color:#a31515>&#39;Convert&#39;</span>:
            input_text = request.form.get(<span style=color:#a31515>&#34;text&#34;</span>)
            parse_form_text(input_text)

        <span style=color:#00f>elif</span> request.form[<span style=color:#a31515>&#39;submit&#39;</span>] == <span style=color:#a31515>&#39;Clear&#39;</span>:
            input_text = <span style=color:#a31515>&#39;&#39;</span>

    <span style=color:green># Render the HTML template. input_text gets fed into the textarea variable in the template</span>
    <span style=color:#00f>return</span> render_template(<span style=color:#a31515>&#39;form.html&#39;</span>, textarea=input_text)

<span style=color:#00f>def</span> parse_form_text(text):
    <span style=color:green># This is where the magic happens</span>
    recipe = rc.RecipeConverter()

    <span style=color:green># split the text to get each line in a list</span>
    text2 = text.split(<span style=color:#a31515>&#39;</span><span style=color:#a31515>\n</span><span style=color:#a31515>&#39;</span>)
    text_converted = recipe.parse_recipe(text2)

    <span style=color:#00f>for</span> line <span style=color:#00f>in</span> text_converted:
        flash(line)

<span style=color:#00f>if</span> __name__ == <span style=color:#a31515>&#39;__main__&#39;</span>:
    app.run()
</code></pre></div><h4 id=formhtml-aka-the-front-end>Form.html (aka the Front End)</h4><p>To accompany our Flask script, we need a usable interface. The interesting bits are encapsulated by <code>{}</code>, and everything else is straight HTML and the <a href=https://getbootstrap.com>Bootstrap library</a>.</p><p>The <code>{{textarea}}</code> is the input variable from <code>render_template()</code> above. For the message flashing, we can loop through the message list using <code>get_flashed_messages()</code>.</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html>&lt;div class=<span style=color:#a31515>&#34;page-header&#34;</span>&gt;
    &lt;h1&gt;Recipe Converter&lt;/h1&gt;
    &lt;p class=<span style=color:#a31515>&#34;lead&#34;</span>&gt;Tired of reading recipes in cups, tablespoons, and teaspoons when you just want everything in grams? Paste your recipe in volumetric units in the textbox below, and hit &#34;Convert&#34;!&lt;/p&gt;
&lt;/div&gt;

<span style=color:green>&lt;!-- Input column (left) --&gt;</span>
&lt;div class=<span style=color:#a31515>&#34;col-md-6&#34;</span>&gt;
    &lt;h2&gt;Input Recipe&lt;/h2&gt;
    &lt;p&gt;
        &lt;form action=<span style=color:#a31515>&#34;&#34;</span> id=<span style=color:#a31515>&#34;textform&#34;</span> method=<span style=color:#a31515>&#34;post&#34;</span>&gt;
            &lt;textarea name=<span style=color:#a31515>&#34;text&#34;</span>&gt;{{textarea}}&lt;/textarea&gt;         <span style=color:green>&lt;!-- Input text box --&gt;</span>
            &lt;br&gt;
            &lt;input type=<span style=color:#a31515>&#34;submit&#34;</span> name=<span style=color:#a31515>&#34;submit&#34;</span> value=<span style=color:#a31515>&#34;Clear&#34;</span>&gt;     <span style=color:green>&lt;!-- &#34;Clear&#34; button --&gt;</span>
            &lt;input type=<span style=color:#a31515>&#34;submit&#34;</span> name=<span style=color:#a31515>&#34;submit&#34;</span> value=<span style=color:#a31515>&#34;Convert&#34;</span>&gt;   <span style=color:green>&lt;!-- &#34;Convert&#34; button --&gt;</span>
        &lt;/form&gt;
    &lt;/p&gt;
&lt;/div&gt;

<span style=color:green>&lt;!-- Output column (right) --&gt;</span>
&lt;div class=<span style=color:#a31515>&#34;col-md-6&#34;</span>&gt;
    &lt;h2&gt;Output Recipe&lt;/h2&gt;
    &lt;p&gt;
        <span style=color:green>&lt;!-- Display each converted line from the flash method (from Flask) --&gt;</span>
        {% with messages = get_flashed_messages() %}
            {% if messages %}
                {% for message in messages %}
                    {{ message }}
                    &lt;br&gt;
                {% endfor %}
            {% endif %}
        {% endwith %}
    &lt;/p&gt;
&lt;/div&gt;
</code></pre></div><p>And we&rsquo;re done! To run the Flask app, we can either execute the Python script by:</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>&gt; python app.py
</code></pre></div><p>Or, as the Flask documentation suggests, we can also use the <code>flask run</code> command after setting the script as the <code>FLASK_APP</code> environment variable.</p><p><strong>Unix Bash (Linux, Mac, etc.):</strong></p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text>$ export FLASK_APP=app.py
$ flask run
</code></pre></div><p><strong>Windows Command Prompt:</strong></p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text>&gt; set FLASK_APP=app.py
&gt; flask run
</code></pre></div><p><strong>Windows PowerShell:</strong></p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text>&gt; $env:FLASK_APP = &#34;app.py&#34;
&gt; flask run
</code></pre></div><div class="row captioned-img"><a href=/imgs/blog-imgs/python-heroku-tutorial/converter%20-%20flask%20demo.gif><img class="img-responsive img-content" src=/imgs/blog-imgs/python-heroku-tutorial/converter%20-%20flask%20demo.gif></a><p class=caption>Running Flask in Visual Studio Code.</p></div><h2 id=deploying-on-heroku-cloud>Deploying on Heroku Cloud</h2><p>First thing&rsquo;s first: Create download <a href=https://devcenter.heroku.com/articles/heroku-cli#download-and-install>Heroku</a> and create an account by running (after the installation completes):</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text>&gt; heroku login
</code></pre></div><p>Heroku should now be initialized on your local system!</p><h3 id=setting-up-the-required-files>Setting Up the Required Files</h3><p>To deploy an application/dyno on Heroku, we need the following files:</p><ul><li><strong>app.py</strong><ul><li>Flask Python script</li></ul></li><li><strong>Procfile</strong><ul><li>Tells Heroku what commands are run by your application&rsquo;s dynos</li></ul></li><li><strong>requirements.txt</strong><ul><li>Tells Heroku what modules it needs to install</li></ul></li><li><strong>runtime.txt</strong><ul><li>Tells Heroku which version of Python to use</li></ul></li></ul><p>The following sections will detail what goes into where.</p><h4 id=procfile>Procfile</h4><p>We&rsquo;ll be using <a href=http://gunicorn.org/>Gunicorn</a> to run our application on Heroku, which is its preferred HTTP server. So in <code>Procfile</code>, add the following line:</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text>web: gunicorn app:app --log-file=-
</code></pre></div><p>However, Gunicorn is only available on Unix systems. If we want to test our Heroku app locally, we&rsquo;ll need to specify another command to run the app. For this, we&rsquo;ll put the following in another file named <code>Procfile.windows</code>:</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text>web: python app.py --log-file=-
</code></pre></div><p>This is functionally equivalent to running the Flask command from before, with the main difference is that this uses Heroku&rsquo;s local hosting framework.</p><h4 id=requirementstxt>Requirements.txt</h4><p>In <code>Requirements.txt</code>, we need to add the dependencies our app has. When we deploy it to Heroku cloud, it will install these modules on the server. Add the following lines:</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text>gunicorn
Flask
</code></pre></div><h4 id=runtimetxt>Runtime.txt</h4><p>Finally, we need to specify that our app runs on Python in <code>runtime.txt</code>. You can check your own version by running <code>python -V</code> or <code>python --version</code>.</p><p>In <code>Runtime.txt</code>:</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text>python-3.6.4
</code></pre></div><h3 id=testing-heroku-locally>Testing Heroku Locally</h3><p>For a minimal application, our file structure should look like the following:</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text>  ├── app.py
  ├── Procfile
  ├── requirements.txt
  └── runtime.txt
</code></pre></div><p>With our recipe converter app (and because we&rsquo;re on Windows), we have the addition of two files shown below:</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text>  ├── app.py
<span style=display:block;width:100%;background-color:#e5e5e5>  ├── recipe-converter.py
</span>  ├── Procfile
<span style=display:block;width:100%;background-color:#e5e5e5>  ├── Procfile.Windows
</span>  ├── requirements.txt
  └── runtime.txt
</code></pre></div><p>If you&rsquo;re on a Unix system, you only need to run <code>heroku local web</code> to start a local server. However, since gunicorn is a webserver that isn&rsquo;t available on Windows (but is required for Heroku), we need to have a separate Procfile for testing on Windows. Thus, we need to add <code>-f procfile.windows</code> to ensure Heroku uses the correct file. So to start Heroku locally on Windows, we can run:</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>&gt; heroku local web -f procfile.windows
</code></pre></div><p>With any luck, the app should compile and run just like it did with Flask!</p><h3 id=pushing-to-heroku-app>Pushing to Heroku App</h3><p>Heroku uses <code>git</code> to receive files to host on <code>herokuapp.com</code>. First, we&rsquo;ll setup the Heroku application with <code>heroku create</code> (where the second argument is the app name, otherwise a randomly generated one will be used).</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>&gt; heroku create recipe-converter-app
</code></pre></div><p>The following commands will create a local git repository and queue all files to be pushed to Heroku&rsquo;s servers.</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>&gt; git init
&gt; git add .
&gt; git commit -m &#39;First commit&#39;
</code></pre></div><p>Finally, we can push and deploy the files to Heroku:</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>&gt; git push heroku master
</code></pre></div><div class="row captioned-img"><a href=/imgs/blog-imgs/python-heroku-tutorial/heroku%20deploy.gif><img class="img-responsive img-content" src=/imgs/blog-imgs/python-heroku-tutorial/heroku%20deploy.gif></a><p class=caption>Heroku output on compile.</p></div><p><strong>Troubleshooting</strong>: If it compiles but fails to load at <code>*.herokuapp.com</code>, you can check the logs with the following command:</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>&gt; heroku logs
</code></pre></div><h3 id=published-to-the-cloud>Published to the Cloud!</h3><p>After all that&rsquo;s been said and done, the recipe converter app is now published on <a href=http://recipe-converter-app.herokuapp.com/>herokuapp.com</a>! It&rsquo;s a freemium service, so it&rsquo;s worth checking out for professional development as well.</p><div class="row captioned-img"><a href=/imgs/blog-imgs/python-heroku-tutorial/converter%20-%20heroku%20demo.gif><img class="img-responsive img-content" src=/imgs/blog-imgs/python-heroku-tutorial/converter%20-%20heroku%20demo.gif></a><p class=caption>The final python app published through Heroku App.</p></div><p>Logging in to <a href=https://dashboard.heroku.com/>dashboard.heroku.com</a> provides a nice dashboard for managing all your deployments, activity, and more.</p><div class="row captioned-img"><a href=/imgs/blog-imgs/python-heroku-tutorial/heroku%20dashboard.PNG><img class="img-responsive img-content" src=/imgs/blog-imgs/python-heroku-tutorial/heroku%20dashboard.PNG></a><p class=caption>Heroku dashboard to manage your dynos.</p></div><h1 id=closing-thoughts>Closing Thoughts</h1><p>To recap our on our journey, we:</p><ul><li>Prototyped the recipe conversions in <a href=https://blog.jupyter.org/jupyterlab-is-ready-for-users-5a6f039b8906>Jupyter Lab&rsquo;s</a> interactive environment</li><li>Migrated script to <a href=https://code.visualstudio.com/>Visual Studio Code</a> to a command line interface</li><li>Integrated the Python script with <a href=http://flask.pocoo.org/>Flask&rsquo;s web framework</a></li><li>Deployed the app through the <a href=https://www.heroku.com/python>Heroku cloud platform</a></li></ul><p>Doing everything in Python has <a href=https://www.probytes.net/blog/advantages-disadvantages-python/>its caveats</a>, but it still can be an excellent tool for quickly getting results. Although the deployed version is still (arguably) a prototype, the amount of legwork we had to accomplish to achieve this end product was relatively minimal!</p><p>As long as we keep in mind that Python is not the solution to everything, we can use it where appropriate and/or when we are aware of its trade-offs.</p><p>Thanks for reading, and I hope you&rsquo;re motivated to either try developing your own app or to stop using volumetric units. If you had to choose one, my vote is on the latter.</p><p>Happy cooking!</p></div><br><div class=text-left><a class=blog-nav-btn href=/><span style=font-size:.83em class="glyphicon glyphicon-menu-left"></span>Recent Posts</a></div><hr><div id=disqus_thread></div><script type=text/javascript>(function(){var a,b;if(window.location.hostname=="localhost")return;a=document.createElement('script'),a.type='text/javascript',a.async=!0,b='justinmklam',a.src='//'+b+'.disqus.com/embed.js',(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(a)})()</script><noscript>Please enable JavaScript to view the <a href=http://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=http://disqus.com/ class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div><div class=col-sm-1><nav id=toc data-toggle=toc data-spy=affix></nav></div></div></div><script src=/js/jquery.js></script><script src=/js/bootstrap.min.js></script><script src=/js/bootstrap-toc.min.js></script><script src=/js/highlight.pack.js></script><script>hljs.initHighlightingOnLoad()</script><script type=text/javascript src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script src=https://use.fontawesome.com/ccb78cc113.js></script><script id=dsq-count-scr src=//justinmklam.disqus.com/count.js async></script><script>$(document).ready(function(){$('#hamburger-menu').click(function(){$(this).toggleClass('open')})})</script></body><footer><div class="col-lg-8 col-centered"><hr><p class=text-center>&copy; 2021 Justin MK Lam</p></div><div id=amzn-assoc-ad-8dae4bf9-b4e8-4c3d-8d99-cd2028a68840></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&adInstanceId=8dae4bf9-b4e8-4c3d-8d99-cd2028a68840"></script></footer></html>