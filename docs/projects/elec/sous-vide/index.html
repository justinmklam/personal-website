<!DOCTYPE html>
<html lang="en">

<head>
    <title>ESP8266 Sous Vide Controller</title>
     <html>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content=
    
        "Immersing food in a temperature controlled water bath."
    
    >
    <meta name="author" content="Justin Lam">

    <link href="/css/jmklam-portfolio-bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Lato:400i,400|Roboto+Slab" rel="stylesheet">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css">

</html>
</head>

<body>

    <!DOCTYPE html>
<html lang="en">


<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
        
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            
                <a class="navbar-brand" href="http://justinmklam.com">Justin Lam</a>
            
        </div>
        
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav">
                
				

                <li><a href="/view-all">Portfolio</a>
				
				
					<li><a href="/pages/about/">About</a></li>
				
					<li><a href="/pages/contact/">Contact</a></li>
				
					<li><a href="/blog">Blog</a></li>
				
					<li><a href="/files/Resume-2016.pdf">CV</a></li>
				

            </ul>
        </div>
        
    </div>
    
</nav>
    
</html>

    
    <div class="container" id="page-container">
        
        <div class="col-sm-8 col-centered">
            <h1 class="page-header">ESP8266 Sous Vide Controller</h1>		            
            

<p><strong>Objective:</strong> Create a small, modular controller to regulate the temperature of a water bath.</p>

<p><strong>Motivation:</strong> To get in on this cooking fad without dropping fat stacks of cash on an immersion circulator.</p>

<p><strong>Features:</strong></p>

<ul>
<li>Crisp 0.96&rdquo; OLED display</li>
<li>Pushbutton rotary encoder provides simple user interaction</li>
<li>Removable temperature plug through standard 3-pos audio connector</li>
<li>Temperature controlled outlet to be used with any heating element (ie. rice cooker, slow cooker, etc.)</li>
<li>Always on outlet for water circulator</li>
<li>Temperature logging over wifi</li>
</ul>

<p><strong>Source:</strong> <a href="https://github.com/justinmklam/sous-vide">Github</a></p>

<!--__Skills:__

+ Firmware programming
+ Enclosure design
+ PCB design-->

<a href=/imgs/sous-vide/IMG_8508.jpg><img class="img-responsive img-content" src=/imgs/sous-vide/IMG_8508.jpg /></a>
<p class="caption">Modular sous vide controller powered by everyone&#39;s favourite WiFi chip, the EPS8266.</p>

<h2 id="the-sous-vide-story">The Sous Vide Story</h2>

<p>You may have heard people rant about this fancy new cooking method that&rsquo;s all the rage right now, but of course you shrug it off as a fad. But here you are, intrigued enough to be reading this article about the very thing you previously rolled your eyes at. So what the heck is sous vide anyway? The peeps over at <a href="https://www.chefsteps.com/activities/what-is-sous-vide">ChefSteps</a> have an answer:</p>

<blockquote>
<p>Imagine you’re cooking a steak. You probably know exactly the color and texture—the doneness, in other words—you’d like, right? With sous vide (say “sue veed”), you simply set a pot of water to the corresponding time and temperature, and you can get that perfect doneness you desire, every time.</p>
</blockquote>

<p>Simply put, you stick the steak in a ziploc bag, stick the bag in the temperature controlled water bath, and wait for the steak to reach thermal equilibrium. After an hour or so, the steak will be the same temperature of the water bath. Need to wait an extra hour before you cook? Not to worry, your steak will be safe since it&rsquo;ll never exceed the temperature of the bath.  With sous vide, say goodbye to overcooked food; physics just won&rsquo;t let it happen.</p>

<a href=/imgs/sous-vide/sousvideTechniques.png><img class="img-responsive img-content" src=/imgs/sous-vide/sousvideTechniques.png /></a>
<p class="caption">Talk nerdy to me about sous vide. (Source: ChefSteps)</p>

<a href=/imgs/sous-vide/what-is-sous-vide.jpg><img class="img-responsive img-content" src=/imgs/sous-vide/what-is-sous-vide.jpg /></a>
<p class="caption">Once immersion circulators came to the consumer market, sous vide became accessible to home kitchens. (Source: Anova Culinary)</p>

<!--<a href=/imgs/sous-vide/Sous-Vide-ENG.jpg><img class="img-responsive img-content" src=/imgs/sous-vide/Sous-Vide-ENG.jpg /></a>
<p class="caption">Why cooking sous vide is worth the effort. (Source: OBH Nordica)</p>-->

<h2 id="the-controller">The Controller</h2>

<p>Wanting to get in on this craze without spending a fortune (especially if it turned out to be a novelty), I set off to make my own. If all a sous vide device does is temperature control of a heating element, then it wouldn&rsquo;t be anything my recent mechatronics degree couldn&rsquo;t handle.</p>

<p><strong>Equipment:</strong></p>

<ul>
<li>Rice cooker to act as the heating element and water vessel</li>
<li><a href="https://www.amazon.ca/gp/product/B00EWENKXO/ref=oh_aui_detailpage_o05_s00?ie=UTF8&amp;psc=1">80 GPH Acquarium pump</a> to circulate the water</li>
<li><a href="https://www.amazon.ca/gp/product/B00KLZQ0P8/ref=oh_aui_detailpage_o09_s00?ie=UTF8&amp;psc=1">DS18B20</a> waterproof temperature sensor</li>
<li>ESP8266 WiFi Chip</li>
</ul>

<a href=/imgs/sous-vide/IMG_8608.jpg><img class="img-responsive img-content" src=/imgs/sous-vide/IMG_8608.jpg /></a>
<p class="caption">DIY sous vide setup with home-made temperature controller.</p>

<a href=/imgs/sous-vide/IMG_8522.jpg><img class="img-responsive img-content" src=/imgs/sous-vide/IMG_8522.jpg /></a>
<p class="caption">Front face of the controller.</p>

<a href=/imgs/sous-vide/IMG_8526.jpg><img class="img-responsive img-content" src=/imgs/sous-vide/IMG_8526.jpg /></a>
<p class="caption">Backside of the controller. Note the switch and cord grip for that back-me-on-Kickstarter finish quality.</p>

<a href=/imgs/sous-vide/IMG_8454.jpg><img class="img-responsive img-content" src=/imgs/sous-vide/IMG_8454.jpg /></a>
<p class="caption">Little space was left unused to minimize the physical footprint of the circuit.</p>

<a href=/imgs/sous-vide/IMG_8432.jpg><img class="img-responsive img-content" src=/imgs/sous-vide/IMG_8432.jpg /></a>
<p class="caption">Reveal of perfboard craftsmanship using the gobs-of-solder trace method.</p>

<a href=/imgs/sous-vide/iUJLGdd.jpg><img class="img-responsive img-content" src=/imgs/sous-vide/iUJLGdd.jpg /></a>
<p class="caption">I designed the panel in SolidWorks, printed out the layout, taped it to a store bought enclosure panel and used a Dremel to carve out the holes.</p>

<a href=/imgs/sous-vide/DCfOE0B.jpg><img class="img-responsive img-content" src=/imgs/sous-vide/DCfOE0B.jpg /></a>
<p class="caption">Dry fitting after a bit of filing to clean up the edges and corners.</p>

<a href=/imgs/sous-vide/IMG_8400.jpg><img class="img-responsive img-content" src=/imgs/sous-vide/IMG_8400.jpg /></a>
<p class="caption">Programming the ESP8266.</p>

<!--<a href=/imgs/sous-vide/IMG_8580.jpg><img class="img-responsive img-content" src=/imgs/sous-vide/IMG_8580.jpg /></a>
<p class="caption">TEXT</p>-->

<a href=/imgs/sous-vide/ui-demo.gif><img class="img-responsive img-content" src=/imgs/sous-vide/ui-demo.gif /></a>
<p class="caption">Push button toggles between three states: main monitoring screen, set cooking time, and set cooking temperature.</p>

<h2 id="the-data">The Data</h2>

<p>No project is complete without analyzing data! The main unknowns thus far:</p>

<ol>
<li>Rise time and stability comparison between various cooking vessels</li>
<li>Temperature stability improvements with a water circulator</li>
<li>Is a bang-bang controller sufficient or is PID required?</li>
</ol>

<p>To assess these questions, I setup the ESP8266 to push live temperature data to an online web server. Through <a href="http://mqtt.org/">MQTT</a>, I was able to send live temperature data from the controller to <a href="https://io.adafruit.com/">Adafruit.IO</a>. This service (in open beta at the time of writing) allows dashboards and data feeds to be easily created for real-time monitoring of anything.</p>

<a href=/imgs/sous-vide/adafruit-dashboard.png><img class="img-responsive img-content" src=/imgs/sous-vide/adafruit-dashboard.png /></a>
<p class="caption">The ESP8266 logs temperature data through Adafruit servers. Data is displayed through their live dashboard feed.</p>

<h3 id="a-comparison-of-cookers">A Comparison of Cookers</h3>

<p>Four trials were conducted with three different cooking vessels: a 3 cup rice cooker, 7 cup rice cooker, and a 14 cup (3.3 L) slow cooker. Two cups of water were used in each vessel for these tests. As shown through the graph below, the rice cookers get up to 55°C significantly than the <em>(very)</em> slow cooker. Although it would be better in maintaining temperature due to its ceramic makeup, it took way too long to heat up for practical purposes. You can fill it with hot/boiling water to help it warm up, but it still wouldn&rsquo;t be as fast or convenient than the rice cookers.</p>

<p>Slow cooker, you are the weakest link. Goodbye.</p>

<a href=/imgs/sous-vide/plot_benchmarks2.png><img class="img-responsive img-content" src=/imgs/sous-vide/plot_benchmarks2.png /></a>
<p class="caption">Comparison of rice and slow cookers with circulated and uncirculated water baths.</p>

<p>Looking at the rice cookers in more detail, we see that the small rice cooker has a much lower overshoot than the large. This makes sense since the heating element is smaller, thus it retains less heat &ldquo;momentum&rdquo; upon shutoff. The addition of a water circulator significantly reduced the steady state temperature oscillation as well as the amplitude of overshoot. With the added benefit of greater temperature uniformity within the water bath than relying on natural convection to mix the water, using a circulator is proven to be a necessity.</p>

<p>Moving forward, I decided to use the large rice cooker with a circulator. Although the small rice cooker reaches steady state more quickly, its small vessel size s unfortunately not practical for cooking anything but a feast for ants.</p>

<a href=/imgs/sous-vide/plot_benchmarks.png><img class="img-responsive img-content" src=/imgs/sous-vide/plot_benchmarks.png /></a>
<p class="caption">Comparison of the remaining cooking vessels.</p>

<a href=/imgs/sous-vide/IMG_8543.jpg><img class="img-responsive img-content" src=/imgs/sous-vide/IMG_8543.jpg /></a>
<p class="caption">Small aquarium pump used to circulate the water.</p>

<p>Time to actually cook with this thing! After trying out various foods, the data shows that the temperature stability is surprisingly stable given the simple on-off temperature control.</p>

<a href=/imgs/sous-vide/plot_cook%20times.png><img class="img-responsive img-content" src=/imgs/sous-vide/plot_cook%20times.png /></a>
<p class="caption">Log of cook times.</p>

<p>Quantifying the ripple with some simple analysis shows that the average standard deviation for these four cooking trials was ±0.4°C, where the steak had the highest deviation of ±0.6°C.</p>

<pre><code>    Trout Fillet at 48C for 59 mins
       Mean:  48.35°C (+1.15, -0.73)
       Std:  ±0.34°C

    Sirloin Steak at 53C for 84 mins
       Mean:  53.03°C (+1.78, -2.65)
       Std:  ±0.63°C

    Chicken Thighs at 70C for 99 mins
       Mean:  70.03°C (+0.59, -1.53)
       Std:  ±0.30°C

    Burger Patty at 60C for 31 mins
       Mean:  60.16°C (+0.72, -0.66)
       Std:  ±0.23°C

    --&gt; AVERAGE STANDARD DEV: ±0.38°C
</code></pre>

<p>Thus, using a simple temperature control implementation with a water circulator yields quite satisfying results.</p>

<h2 id="the-verdict">The Verdict</h2>

<p>They say a picture is worth a thousand words. The one below might not be worth quite that many, but that pink uniformity definitely speaks for itself.</p>

<a href=/imgs/sous-vide/IMG-20161231-WA0007.jpg><img class="img-responsive img-content" src=/imgs/sous-vide/IMG-20161231-WA0007.jpg /></a>
<p class="caption">A uniformly cooked sirloin steak finished on a cast-iron pan.</p>

			
            <br>

            
            <div class="row">
                
                <div class="col-sm-9 col-sm-push-3">
                    <p class="datestamp"><span class="glyphicon glyphicon-time"></span> Published on February 5, 2017</p>
                </div>   
                
                <div class="col-sm-3 col-sm-pull-9">
                    <a class="text-left" href="/view-all">
                        <span style="font-size:0.83em" class="glyphicon glyphicon-menu-left"></span>All Projects
                    </a>
                </div>                             
            </div>
			
        </div>

		
		
    </div>	
    

	    
    <script src="http://justinmklam.com/js/jquery.js"></script>

    
    <script src="http://justinmklam.com/js/bootstrap.min.js"></script>

    
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    
    <script src="https://use.fontawesome.com/ccb78cc113.js"></script>

</body>
    

<footer>
	<div class="col-lg-8 col-centered">
		<hr>
		<p class="text-center">&copy; 2017 Justin MK Lam</p>
	</div>
</footer>

</html>